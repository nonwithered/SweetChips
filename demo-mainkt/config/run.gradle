def cmdKotlin = gradle.ext.isWindows()
        ? 'kotlin.bat'
        : 'kotlin'

def jarPath = project.buildDir.toPath()
        .resolve('libs')
        .resolve("${project.name}.jar")

task testDemo(type: Exec) {
    dependsOn project(':demo-main').tasks.testDemoMvn
    dependsOn project(':demo-mainkt').tasks.assemble
    commandLine "$cmdKotlin",
            '-cp', "${jarPath.toAbsolutePath()}",
            "$project.ext.mainClass"
    doFirst {
        standardOutput = System.out
        errorOutput = System.err
    }
}